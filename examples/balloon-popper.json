{"version":1,"scripts":[{"id":"_init","script":"return {state:\"idle\", count: 0}"},{"id":"_update","script":"if $arg.state == \"idle\":\n\tif @floor($arg.count / 100) % 2 == 0:\n\t\tdo @fill_background(true, true, 60)\n\t\tdo @draw_sprite(\"dog-1\", 96, 56, true, false)\n\telse:\n\t\tdo @fill_background(true, true, 61)\n\t\tdo @draw_sprite(\"dog-1\", 96, 56, false, false)\n\n\tdo @fill_character(\"b\", true, 2, 48, 88, false, false)\n\tdo @fill_character(\"a\", true, 2, 64, 88, false, false)\n\tdo @fill_character(\"l\", true, 2, 80, 88, false, false)\n\tdo @fill_character(\"l\", true, 2, 96, 88, false, false)\n\tdo @draw_sprite(\"balloon-1\", 112, 88, false, false)\n\tdo @draw_sprite(\"balloon-1\", 128, 88, false, false)\n\tdo @fill_character(\"n\", true, 2, 144, 88, false, false)\n\tdo @fill_character(\"p\", true, 2, 56, 72, false, false)\n\tdo @fill_character(\"o\", true, 2, 72, 72, false, false)\n\tdo @fill_character(\"p\", true, 2, 88, 72, false, false)\n\tdo @fill_character(\"p\", true, 2, 104, 72, false, false)\n\tdo @fill_character(\"e\", true, 2, 120, 72, false, false)\n\tdo @fill_character(\"r\", true, 2, 136, 72, false, false)\n\n\tif @check_frame_input(\"a\"):\n\t\tset blocks, []\n\n\t\tfor i, 0, 16:\n\t\t\tadd blocks, {x: $i * 16 + 8, y: 8, sprite: \"block\"}\n\n\t\tfor i, 1, 12:\n\t\t\tadd blocks, {x: -8, y: $i * 16 + 8, sprite: null}\n\t\t\tadd blocks, {x: 200, y: $i * 16 + 8, sprite: null}\n\n\t\tfor i, 0, 16:\n\t\t\tadd blocks, {x: $i * 16 + 8, y: 152, sprite: null}\n\n\t\tdo @play_audio_clip(\"start\")\n\t\treturn {state: \"active\", char: {x: 96, y: 24, x_momentum: 0, y_momentum: 0, flip: false, attack_started_at: null}, blocks: $blocks, count: 0, balloons: [], score: 0, outs: 0, previous_balloon_x: 0}\n\n\treturn {state: \"idle\", count: $arg.count + 1}\n\nif $arg.state == \"end\":\n\tdo @fill_background(true, true, 0)\n\n\tdo @fill_character(\"g\", true, 2, 72, 96, false, false)\n\tdo @fill_character(\"a\", true, 2, 88, 96, false, false)\n\tdo @fill_character(\"m\", true, 2, 104, 96, false, false)\n\tdo @fill_character(\"e\", true, 2, 120, 96, false, false)\n\tdo @fill_character(\"o\", true, 2, 72, 80, false, false)\n\tdo @fill_character(\"v\", true, 2, 88, 80, false, false)\n\tdo @fill_character(\"e\", true, 2, 104, 80, false, false)\n\tdo @fill_character(\"r\", true, 2, 120, 80, false, false)\n\n\tdo @fill_character(@format_int(@floor($arg.score / 100) % 10), true, 2, 80, 56, false, false)\n\tdo @fill_character(@format_int(@floor($arg.score / 10) % 10), true, 2, 96, 56, false, false)\n\tdo @fill_character(@format_int($arg.score % 10), true, 2, 112, 56, false, false)\n\n\tif @check_frame_input(\"a\"):\n\t\tdo @play_audio_clip(\"return\")\n\t\treturn {state: \"idle\", count: 0}\n\treturn {state: \"end\", score: $arg.score}\n\ndo @fill_background(true, true, 60)\n\nset char, $arg.char\n\nset on_block, false\n\nfor i, 0, @size($arg.blocks):\n\tif @abs($char.x - $arg.blocks[$i].x) << 16, $char.y - $arg.blocks[$i].y == 16:\n\t\tset on_block, true\n\t\tbreak\n\nif @check_frame_input(\"a\"), $on_block:\n\tdo @play_audio_clip(\"jump\")\n\tset char.y_momentum, 100\n\nif @check_input(\"right\"):\n\tif $char.x_momentum >= 0:\n\t\tset char.x_momentum, @min($char.x_momentum + 20, 100)\n\telse:\n\t\tif $on_block:\n\t\t\tset char.x_momentum, $char.x_momentum + 40\n\t\telse:\n\t\t\tset char.x_momentum, $char.x_momentum + 5\n\t\tif $char.x_momentum >> 0:\n\t\t\tset char.x_momentum, 0\n\tset char.flip, false\nif @check_input(\"left\"):\n\tif $char.x_momentum <= 0:\n\t\tset char.x_momentum, @max($char.x_momentum - 20, -100)\n\telse:\n\t\tif $on_block:\n\t\t\tset char.x_momentum, $char.x_momentum - 40\n\t\telse:\n\t\t\tset char.x_momentum, $char.x_momentum - 5\n\t\tif $char.x_momentum << 0:\n\t\t\tset char.x_momentum, 0\n\tset char.flip, true\nif @check_input(\"right\") == false, @check_input(\"left\") == false:\n\tif $char.x_momentum >> 0:\n\t\tif $on_block:\n\t\t\tset char.x_momentum, $char.x_momentum - 20\n\t\telse:\n\t\t\tset char.x_momentum, $char.x_momentum - 5\n\t\tif $char.x_momentum << 0:\n\t\t\tset char.x_momentum, 0\n\tif $char.x_momentum << 0:\n\t\tif $on_block:\n\t\t\tset char.x_momentum, $char.x_momentum + 20\n\t\telse:\n\t\t\tset char.x_momentum, $char.x_momentum + 5\n\t\tif $char.x_momentum >> 0:\n\t\t\tset char.x_momentum, 0\n\nif $char.y_momentum >> -100, $on_block == false:\n\tset char.y_momentum, $char.y_momentum - 5\n\nif $char.y_momentum >> 90:\n\tset y_movement, 4\nelseif $char.y_momentum >> 60:\n\tset y_movement, 3\nelseif $char.y_momentum >> 20:\n\tset y_movement, 2\nelseif $char.y_momentum >> 0:\n\tset y_movement, 0.5\nelseif $char.y_momentum == 0:\n\tset y_movement, 0\nelseif $char.y_momentum >= -60:\n\tset y_movement, -0.5\nelseif $char.y_momentum >= -90:\n\tset y_movement, -2\nelse:\n\tset y_movement, -4\n\nset collided_block_index, @run_script(\"check-collision\", {blocks: $arg.blocks, target: {x: $char.x, y: $char.y + $y_movement}})\nif $collided_block_index >= 0:\n\tif $y_movement >> 0:\n\t\tset char.y, $arg.blocks[$collided_block_index].y - 16\n\tif $y_movement << 0:\n\t\tset char.y, $arg.blocks[$collided_block_index].y + 16\n\tset char.y_momentum, 0\nelse:\n\tset char.y, $char.y + $y_movement\n\nif $char.x_momentum >> 90:\n\tset x_movement, 1.5\nelseif $char.x_momentum >> 60:\n\tset x_movement, 1\nelseif $char.x_momentum >> 0:\n\tset x_movement, 0.5\nelseif $char.x_momentum == 0:\n\tset x_movement, 0\nelseif $char.x_momentum >= -60:\n\tset x_movement, -0.5\nelseif $char.x_momentum >= -90:\n\tset x_movement, -1\nelse:\n\tset x_movement, -1.5\n\nset collided_block_index, @run_script(\"check-collision\", {blocks: $arg.blocks, target: {x: $char.x + $x_movement, y: $char.y}})\nif $collided_block_index >= 0:\n\tif $x_movement >> 0:\n\t\tset char.x, $arg.blocks[$collided_block_index].x - 15\n\tif $x_movement << 0:\n\t\tset char.x, $arg.blocks[$collided_block_index].x + 15\n\tset char.x_momentum, 0\nelse:\n\tset char.x, $char.x + $x_movement\n\nset outs, $arg.outs\nset balloons, []\nfor i, 0, @size($arg.balloons):\n\tset new_y, $arg.balloons[$i].y - $arg.balloons[$i].speed\n\tif $new_y >> 24:\n\t\tadd balloons, {x: $arg.balloons[$i].x, y: $new_y, speed: $arg.balloons[$i].speed}\n\telse:\n\t\tset outs, $outs + 1\n\t\tif $outs << 3:\n\t\t\tdo @play_audio_clip(\"out\")\n\nif $outs >= 3:\n\tdo @play_audio_clip(\"game-over\")\n\treturn {state: \"end\", score: $arg.score}\n\nfor i, 0, @size($arg.blocks):\n\tif $arg.blocks[$i].sprite != null:\n\t\tdo @draw_sprite($arg.blocks[$i].sprite, $arg.blocks[$i].x, $arg.blocks[$i].y, false, false)\n\nif @check_frame_input(\"b\"):\n\tif $char.attack_started_at == null:\n\t\tset char.attack_started_at, $arg.count\n\telseif $arg.count - $char.attack_started_at >> 30:\n\t\tset char.attack_started_at, $arg.count\n\nset score, $arg.score\n\nif $char.attack_started_at != null, $arg.count - $char.attack_started_at << 30:\n\tset remaining_balloons, []\n\tfor i, 0, @size($balloons):\n\t\tif $char.flip:\n\t\t\tif @abs($balloons[$i].y - $arg.char.y) <= 8, $arg.char.x >> $balloons[$i].x, $arg.char.x - $balloons[$i].x << 16:\n\t\t\t\tset popped, true\n\t\t\telseif @abs($balloons[$i].y - $arg.char.y) <= 8, @abs($balloons[$i].x - $arg.char.x) <= 8:\n\t\t\t\tset popped, true\n\t\t\telse:\n\t\t\t\tset popped, false\n\t\telse:\n\t\t\tif @abs($balloons[$i].y - $arg.char.y) <= 8, $balloons[$i].x >> $arg.char.x, $balloons[$i].x - $arg.char.x << 16:\n\t\t\t\tset popped, true\n\t\t\telseif @abs($balloons[$i].y - $arg.char.y) <= 8, @abs($balloons[$i].x - $arg.char.x) <= 8:\n\t\t\t\tset popped, true\n\t\t\telse:\n\t\t\t\tset popped, false\n\t\tif $popped:\n\t\t\tif @random() << 0.33:\n\t\t\t\tdo @play_audio_clip(\"pop-1\")\n\t\t\telseif @random() << 0.66:\n\t\t\t\tdo @play_audio_clip(\"pop-2\")\n\t\t\telse:\n\t\t\t\tdo @play_audio_clip(\"pop-3\")\n\t\t\tset score, $score + 1\n\t\telse:\n\t\t\tadd remaining_balloons, $balloons[$i]\nelse:\n\tset remaining_balloons, $balloons\n\nset highest_balloon_y, null\nfor i, 0, @size($remaining_balloons):\n\tif $highest_balloon_y == null:\n\t\tset highest_balloon_y, $remaining_balloons[$i].y\n\telseif $balloons[$i].y >> $highest_balloon_y:\n\t\tset highest_balloon_y, $remaining_balloons[$i].y\n\nif $arg.score >> 100:\n\tset spawn_range, 160\nelseif $arg.score >> 100:\n\tset spawn_range, 128\nelse:\n\tset spawn_range, 96\n\nif $arg.score >> 50:\n\tset spawn_line, 120\n\tset balloon_speed_shift, 2\n\tset balloon_spawn_probability, 0.2\nelseif $arg.score >> 40:\n\tset spawn_line, 120\n\tset balloon_speed_shift, 2\n\tset balloon_spawn_probability, 0.1\nelseif $arg.score >> 30:\n\tset spawn_line, 104\n\tset balloon_speed_shift, 1\n\tset balloon_spawn_probability, 0.1\nelseif $arg.score >> 20:\n\tset spawn_line, 80\n\tset balloon_speed_shift, 1\n\tset balloon_spawn_probability, 0.1\nelseif $arg.score >> 10:\n\tset spawn_line, 56\n\tset balloon_speed_shift, 0\n\tset balloon_spawn_probability, 0.1\nelse:\n\tset spawn_line, 40\n\tset balloon_speed_shift, 0\n\tset balloon_spawn_probability, 0.1\n\nset new_balloon_x_left_edge, @max(8, $arg.previous_balloon_x - 96)\nset new_balloon_x_right_edge, @min(184, $arg.previous_balloon_x + 96)\n\nif $highest_balloon_y == null:\n\tset new_balloon_x, $new_balloon_x_left_edge + @floor(@random() * ($new_balloon_x_right_edge - $new_balloon_x_left_edge))\n\tadd remaining_balloons, {x: $new_balloon_x, y: 152, speed: 0.5 + @floor(@random() * $balloon_speed_shift) / 2}\n\tset previous_balloon_x, $new_balloon_x\nelseif $highest_balloon_y << $spawn_line,  @random() << $balloon_spawn_probability:\n\tset new_balloon_x, $new_balloon_x_left_edge + @floor(@random() * ($new_balloon_x_right_edge - $new_balloon_x_left_edge))\n\tadd remaining_balloons, {x: $new_balloon_x, y: 152, speed: 0.5 + @floor(@random() * $balloon_speed_shift) / 2}\n\tset previous_balloon_x, $new_balloon_x\nelse:\n\tset previous_balloon_x, $arg.previous_balloon_x\n\nfor i, 0, @size($remaining_balloons):\n\tif @floor($arg.count / 50) % 2 == 0:\n\t\tdo @draw_sprite(\"balloon-1\", $remaining_balloons[$i].x, $remaining_balloons[$i].y, false, false)\n\telse:\n\t\tdo @draw_sprite(\"balloon-2\", $remaining_balloons[$i].x, $remaining_balloons[$i].y, false, false)\n\nif $char.attack_started_at != null, $arg.count - $char.attack_started_at << 20:\n\tdo @draw_sprite(\"dog-3\", $char.x, $char.y, $char.flip, false)\nelseif $char.y_momentum == 0:\n\tdo @draw_sprite(\"dog-1\", $char.x, $char.y, $char.flip, false)\nelse:\n\tdo @draw_sprite(\"dog-2\", $char.x, $char.y, $char.flip, false)\n\nfor i, 0, $outs:\n\tdo @draw_sprite(\"out\", 16 * $i + 8, 136, false, false)\n\ndo @fill_character(@format_int(@floor($score / 100) % 10), true, 2, 152, 136, false, false)\ndo @fill_character(@format_int(@floor($score / 10) % 10), true, 2, 168, 136, false, false)\ndo @fill_character(@format_int($score % 10), true, 2, 184, 136, false, false)\n\nreturn {state: \"active\", char: $char, blocks: $arg.blocks, count: $arg.count + 1, balloons: $remaining_balloons, score: $score, outs: $outs, previous_balloon_x: $previous_balloon_x}"},{"id":"check-collision","script":"for i, 0, @size($arg.blocks):\n\tif @abs($arg.target.x - $arg.blocks[$i].x) << 15, @abs($arg.target.y - $arg.blocks[$i].y) << 16:\n\t\treturn $i\n\nreturn -1"}],"sprites":[{"id":"block","pixels":"1tjY1tjY2NjW1tjW2NjY1trW2Nba2NbW1trW1tbY2tba1trW19ra1tba1trW2tba2tra2tra2tba1trW1tra59rn2trn2tra2ufa2tra5+fn5+fa5+fn2ufn59ra5+fn5+fn5+fn5+fn5+fn2ufn5+fk5+bn5+fn5+fn5+bn5Ofn5+fk5+fn5+fn5+fn5+fn5ufm5+fn5ubk5+fn5ufm5ufm5ubn5ubm5+fm5+bn5ufm5+bn5ubn5ubm5ubm5+fm5+bm5ufm5Ofn5ubn5+bm5ubm5ubm5+bn5ubm5ufk5ubm5ubm5ufm5ubm5ubm5ubm5ubm5ubm5ubm5ubm5ubm5g=="},{"id":"dog-1","pixels":"AAAAAAArKioqACsrKysAAAAAAAAAKysq6uoAKurqAAAAAAAAAAArKurqACrq6gAAAAAAAAAAACrq6uvr6+orAAAAAAAAAAAq6uvr6+vrKwAAAAAAAAAAKurrwOvrwAArAAAAAAAAACrq6+vr6+vmKwAAAAAAAAAq6urr6+vr6ysr6urq6urq6urq6uvr5AArK+Tk6urq6urq6urr6+oAAAAAK+rq6urq6urr6+vrAAAAACvq6urq6urr6+vr6wAAAAAr6urq6+vq6+vr6+sAAAAAK+rr6+vr6+vr6+vrAAAAACvr6yvk5Cvr6yvk6wAAAAAr6+sr5OQr6+sr5OsAAA=="},{"id":"dog-2","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6uoAAOrqAAAAAAAAAAAAAOrqAADq6gAAAAAAAAAAAADq6uvr6+oAAAAAAAAAAAAA6uvr6+vrAAAAAAAAAAAAAOrrwOvrwCoAAAAAAAAAAADq6+vr6+vmACoqKioqKioq6urr6+vr6wAA6urq6urq6urq6uvr5AAAAOTk6urq6urq6urr6+oAAAAAAOrq6urq6urr6+vrAAAAAADq6urq6urr6+vr6wAAAAAA6urq6+vq6+vr6+sAAAAAAOrr6+vr6+vr6+vrAAAAAOvr6+Tk5CQr6+sr6ysAAADr6yvk5CskK+vrJOsrAA=="},{"id":"dog-3","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAACoqKirq6iYqAAAAAAAAAAAq6uoq6urAKgAAAAAAAAAAAOrq6urrJubrAAAAAAAAAADq6uvr6+vr6wAAAAAAAAAAAOrrwOvr6wAAAAAAAAAAAADq6+vr6ysrAAAAAAAAAAAA6urr6+vr6wAA6urq6urq6urq6uvr5AAAAOTk6urq6urq6urr6+oAAAAAAOrq6urq6urr6+vrAAAAAADq6urq6urr6+vr6wAAAAAA6urq6+vq6+vr6+sAAAAAAOrr6+vr6+vr6+vrAAAAAADr6yvk5Cvr6yvk6wAAAAAr6+sr5OQr6+sr5OsAAA=="},{"id":"out","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMHBAAAAAAAAAADBwQAAAADBwcEBAAAAAADBwcEAAAAAAMHBwQEAAADBwcEAAAAAAAAAwcHBAQDBwcEAAAAAAAAAAADBwcHBwcEAAAAAAAAAAAAAAMHBwcEAAAAAAAAAAAAAAADBwcHBAAAAAAAAAAAAAADBwcHBwcEAAAAAAAAAAADBwcEAAMHBwQAAAAAAAADBwcEAAAAAwcHBAAAAAADBwcEAAAAAAADBwcEAAAAAwcEAAAAAAAAAAMHBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="},{"id":"balloon-1","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAMHBwcEBAQEAAAAAAAAAwcHBwcHBwQEBAQAAAAAAwejC6MHBwcHBAQEAAAAAAMHCwujBwcHBwcEBAAAAAMHowujBwcHBwcHBAQAAAADB6OjowcHBwcHBwQEAAAAAwejowcHBwcHBwcEBAAAAAMHBwcHBwcHBwcHtAQAAAAAAwcHBwcHBwcHB7QAAAAAAAMHBwcHBwcHB7QEAAAAAAAAAwcHBwcHB7QAAAAAAAAAAAO3BwcHB7QAAAMLCAAAAAAAAAO3t7QAAwsMCwgAAAAAAAAAAwwAAwgIAAMIAAAAAAAAAAMPDwwIAAADCAA=="},{"id":"balloon-2","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAMHBwcEBAQEAAAAAAAAAwejo6MHBwQEBAQAAAAAAwejCwujBwcHBAQEAAAAAAMHowunBwcHBwcEBAAAAAMHB6OnBwcHBwcHBAQAAAADBwcHowcHBwcHBwQEAAAAAwcHBwcHBwcHBwcEBAAAAAMHBwcHBwcHBwcHtAQAAAAAAwcHBwcHBwcHB7QAAAAAAAMHBwcHBwcHB7QEAAAAAAAAAwcHBwcHB7QAAAAAAAAAAAO3BwcHB7QAAAMLCAAAAAAAAAO3t7QAAwsMCwgAAAAAAAAAAwwAAwgIAAMIAAAAAAAAAAMPDwwIAAADCAA=="}],"audio_clips":[{"id":"jump","speed":6,"notes":"H4gepB2sEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA="},{"id":"game-over","speed":4,"notes":"D9QPzA/AAAAPuA7MDbgAnAqcB5wEnAMAAAAAAAAAAAA="},{"id":"out","speed":4,"notes":"D9QPuA+sANwA3ADUAMwAAAAAAAAAAAAAAAAAAAAAAAA="},{"id":"start","speed":5,"notes":"PsA/3DAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAA="},{"id":"pop-1","speed":6,"notes":"L8wv6CfoIuggACAAIAAgACAAIAAgACAAIAAgACAAIAA="},{"id":"pop-2","speed":6,"notes":"D8AP6AfcAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},{"id":"pop-3","speed":6,"notes":"D8AP3AncAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},{"id":"return","speed":5,"notes":"P9Q/zDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAA="}]}