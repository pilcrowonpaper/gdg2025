{"version":1,"scripts":[{"id":"_init","script":"return {state: \"idle\", global_count: 0}"},{"id":"_update","script":"if $arg.state == \"idle\":\n\tdo @fill_background(true, true, 60)\n\n\tdo @fill_character(\"j\", true, 2, 72, 96, false, false)\n\tdo @fill_character(\"u\", true, 2, 88, 96, false, false)\n\tdo @fill_character(\"m\", true, 2, 104, 96, false, false)\n\tdo @fill_character(\"p\", true, 2, 120, 96, false, false)\n\tdo @fill_character(\"g\", true, 2, 72, 80, false, false)\n\tdo @fill_character(\"a\", true, 2, 88, 80, false, false)\n\tdo @fill_character(\"m\", true, 2, 104, 80, false, false)\n\tdo @fill_character(\"e\", true, 2, 120, 80, false, false)\n\n\tfor i, 0, 17:\n\t\tdo @draw_sprite(\"ground-2\", $i * 16 + 8, 8, false, false)\n\t\tdo @draw_sprite(\"ground-1\", $i * 16 + 8, 24, false, false)\n\n\tif @check_frame_input(\"a\"):\n\t\tdo @play_audio_clip(\"start\")\n\t\treturn {state: \"active\", count: 0, main: {x: 64, y: 40, state: \"idle\", sprite: null}, enemies: [], global_count: $arg.global_count + 1, score: 0}\n\treturn {state: \"idle\", global_count: $arg.global_count + 1}\n\nif $arg.state == \"active\":\n\tdo @fill_background(true, true, 60)\n\n\tset calculate_result, @run_script(\"calculate\", {main: $arg.main, enemies: $arg.enemies, count: $arg.count, score: $arg.score})\n\n\tfor i, 0, @size($calculate_result.audio_clips):\n\t\tdo @play_audio_clip($calculate_result.audio_clips[$i])\n\n\tif $calculate_result.continue == false:\n\t\tdo @fill_background(true, true, 0)\n\t\treturn {state: \"end\", score: $calculate_result.score, global_count: $arg.global_count + 1}\n\n\tdo @draw_sprite($calculate_result.main.sprite, $calculate_result.main.x, $calculate_result.main.y, false, false)\n\n\tfor i, 0, @size($calculate_result.enemies):\n\t\tdo @draw_sprite($calculate_result.enemies[$i].sprite, $calculate_result.enemies[$i].x, $calculate_result.enemies[$i].y, true, false)\n\n\tfor i, 0, 17:\n\t\tdo @draw_sprite(\"ground-2\", $i * 16 + 8 - ($arg.count * 1 % 16), 8, false, false)\n\t\tdo @draw_sprite(\"ground-1\", $i * 16 + 8 - ($arg.count * 1 % 16), 24, false, false)\n\n\tdo @fill_character(@format_int(@floor($calculate_result.score / 1000) % 10), true, 2, 136, 136, false, false)\n\tdo @fill_character(@format_int(@floor($calculate_result.score / 100) % 10), true, 2, 152, 136, false, false)\n\tdo @fill_character(@format_int(@floor($calculate_result.score / 10) % 10), true, 2, 168, 136, false, false)\n\tdo @fill_character(@format_int($calculate_result.score % 10), true, 2, 184, 136, false, false)\n\n\treturn {state: \"active\", count: $arg.count + 1, main: $calculate_result.main, enemies: $calculate_result.enemies, score: $calculate_result.score, global_count: $arg.global_count + 1}\n\nif $arg.state == \"end\":\n\tdo @fill_background(true, true, 0)\n\n\tdo @fill_character(\"g\", true, 2, 72, 96, false, false)\n\tdo @fill_character(\"a\", true, 2, 88, 96, false, false)\n\tdo @fill_character(\"m\", true, 2, 104, 96, false, false)\n\tdo @fill_character(\"e\", true, 2, 120, 96, false, false)\n\tdo @fill_character(\"o\", true, 2, 72, 80, false, false)\n\tdo @fill_character(\"v\", true, 2, 88, 80, false, false)\n\tdo @fill_character(\"e\", true, 2, 104, 80, false, false)\n\tdo @fill_character(\"r\", true, 2, 120, 80, false, false)\n\n\tdo @fill_character(@format_int(@floor($arg.score / 1000) % 10), true, 2, 72, 56, false, false)\n\tdo @fill_character(@format_int(@floor($arg.score / 100) % 10), true, 2, 88, 56, false, false)\n\tdo @fill_character(@format_int(@floor($arg.score / 10) % 10), true, 2, 104, 56, false, false)\n\tdo @fill_character(@format_int($arg.score % 10), true, 2, 120, 56, false, false)\n\n\tif @check_frame_input(\"a\"):\n\t\tdo @play_audio_clip(\"restart\")\n\t\treturn {state: \"idle\", global_count: $arg.global_count + 1}\n\treturn {state: \"end\", score: $arg.score, global_count: $arg.global_count + 1}"},{"id":"calculate","script":"set audio_clips, []\n\nset main_sprite, \"char-a.1\"\n\n# \"a\" ボタンが押されている かつ\n# \"idle\" 状態\nif @check_frame_input(\"a\"), $arg.main.state == \"idle\":\n\t# y を y + 2\n\t# 状態 state を \"up\"\n\tset main, {x: $arg.main.x, y: $arg.main.y + 2, state: \"up\", sprite: $main_sprite}\n\n\t# \"jump\" 効果音を流す\n\tadd audio_clips, \"jump\"\n\n# \"up\" 状態\nelseif $arg.main.state == \"up\":\n\tif $arg.main.y << 72:\n\t\tset main, {x: $arg.main.x, y: $arg.main.y + 2, state: \"up\", sprite: $main_sprite}\n\telseif $arg.main.y << 80:\n\t\tset main, {x: $arg.main.x, y: $arg.main.y + 1, state: \"up\", sprite: $main_sprite}\n\telse:\n\t\tset main, {x: $arg.main.x, y: $arg.main.y + 0.5, state: \"up\", sprite: $main_sprite}\n\t\n\t# ジャンプの頂点（y=88）\n\tif $main.y >= 88:\n\t\t# 88以上行った可能性もあるから修正\n\t\tset main.y, 88\n\t\tset main.state, \"down\"\nelseif $arg.main.state == \"down\":\n\tif $arg.main.y >> 72:\n\t\tset main, {x: $arg.main.x, y: $arg.main.y - 1, state: \"down\", sprite: $main_sprite}\n\telse:\n\t\tset main, {x: $arg.main.x, y: $arg.main.y - 3, state: \"down\", sprite: $main_sprite}\n\t# 地面 (y=40)\n\tif $main.y <= 40:\n\t\tset main.y, 40\n\t\tset main.state, \"idle\"\nelse:\n\tset main, {x: $arg.main.x, y: $arg.main.y, state: $arg.main.state, sprite: $main_sprite}\n\nset enemies, []\n\n# もう見えない enemy を消す\nfor i, 0, @size($arg.enemies):\n\tif $arg.enemies[$i].x >> -8:\n\t\tadd enemies, {x: $arg.enemies[$i].x - 1, y: $arg.enemies[$i].y, sprite: $arg.enemies[$i].sprite}\n\n# 全ての enemies に対して\nfor i, 0, @size($enemies):\n\t# x と y を比べて衝突判定\n\tif @abs($enemies[$i].x - $main.x) << 14, @abs($enemies[$i].y - $main.y) << 14:\n\t\t# continue: false でゲームオーバー\n\t\treturn {main: $main, enemies: $enemies, continue: false, score: @floor($arg.count / 100), audio_clips: [\"end\"]}\n\n# もう敵がいない かつ\n# 10%の確率\nif @size($enemies) == 0, @random() << 0.1:\n\t# enemies に新しい敵を追加\n\tadd enemies, {x: 200, y: 40, sprite: \"char-b.3\"}\n\n# フレームの状態を結果として返す\n# 1秒に1000回実行するから @floor($arg.count / 100) = 経過した時間（秒）\nreturn {main: $main, enemies: $enemies, continue: true, score: @floor($arg.count / 100), audio_clips: $audio_clips}"}],"sprites":[{"id":"ground-1","pixels":"09XT1dXT09PV09PV09PT09ra2tra2tra2tra2tra2tra2tra2tDa2tra2tra2tra2tDQ2tDQ2tDa2tra2tDQ2tra2tDQ0NDa2tra2tDQ0NDQ2tDQ0NXQ0NDQ2tDQ0NXa0NDQ2tXQ0NDV2tra1dXV1dXa0NDV1dDa0Nra0NDV1dXV1dXV1dXV0NDQ0NDV4uLQ4tXV4uLi1dDQ0NXV1eLi4uLi1eLj4tXV0NXV0OLV4uLj4tXj4+Pi1dXV1eLj4+Pi4+PV4+Tj4+LV1eLj4+Lj4+Pi49Xj4+Pi4uLj4+Pi4+Pj4+Pj4+Pj4+Pj4+Lj4+Pj4+Pj4+Pj4+Pj4+Pj5OPj4w=="},{"id":"ground-2","pixels":"4+Pj4+Pj4+Pj4+Pj4+Pj4+Pi4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4+Pj4uLj4+Pj4+Pj4+Pj4+Pj4+Pi4uPj4uPj4+Pj4+Li4+Pj4+Pi4+Pj4+Li4uPj4+Pj4+Pj4+Pj4+Li4uLi4+Pi4uPj4+Pj4+Li4uLi4uLi4uLj4+Pj4+Li4uPi4uLi4uLi4uLj4uLi4uLi5OLi4uLi4uLi4uLi4uLi4uLi4uLi4uLj4uPi4uLi4uLi4uLi4uLi4uXi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4+Li4uLi4uLi4uLi4uLi4uPj4uLi4uLi4uLi4uLi4uLi4uTi4uLi4uLi4g=="},{"id":"char-a.1","pixels":"AAAAAAAAAAAA9/f39wAAAAAAAAAAAAAA9/v7+/v3AAAAAAAAAAAA98L7+/v7+/cAAAAAAAAAAPf7+/vA+/v3AAAAAAAAAAD3+/Ly+/v3AAAAAAAAAAAA9/v7+/z3AAAAAAAAAAAAAP77+/v79wAAAAAAAAAAAAD++/v7+/43AAAAAAAA9/f++/v7+/v79wAAAAD39/v7+/v7+/v7+/cAAAD3+/v7+/v7+/v7+/v3AAD3+/v7+/v7+/v7+/v8/gAA9/f+/Pv7/Pz8+/v8/gAAAAAA9/v7/P739/z7/v4AAAAAAPf3/P73APf+/PcAAAAAAAAA9/f3AAAA9/f3AAAAAA=="},{"id":"char-a.2","pixels":"AAAAAAAAAAAAAPf39/cAAAAAAAAAAAAAAPf7+/v79wAAAAAAAAAAAPfC+/v7+/v3AAAAAAAAAAD3+/v7wPv79wAAAAAAAAAA9/vy8vv79wAAAAAAAAAAAP77+/v89wAAAAAAAAAAAP78+/v7+/cAAAAAAAAAAAD++/v7+/v3AAAAAAAA9/f++/v7+/v79wAAAAD39/v7+/v7+/v7+/cAAAD3+/v7+/v7+/v7+/v+AAD3+/v7+/v7+/v7+/v8/gAA9/f+/Pv8/Pz8+/v79wAAAAAA9/v7/vf3/vz7/P4AAAAAAPf8/Pf+APf8/Pf+AAAAAAD39/f+AAD39/f+/gAAAA=="},{"id":"char-a.3","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD39/f3AAAAAAAAAAAAAAD3+/v7+/cAAAAAAAAAAAD3wvv7+/v79wAAAAAAAAAA9/v7+8D7+/cAAAAAAAAAAPf78vL7+/cAAAAAAAAAAAD++/v7/PcAAAAAAAAAAAD+/Pv7+/v3AAAA9/f39/f+/Pv7+/v79wAA9/v7+/v7+/v7+/v7+/cAAPf++/v7+/v7+/v7+/v+AAAAAP78+/v7+/v7+/v8/gAAAAD++/v8/Pz8+/v79/4AAAAA9/v89/f39/v7/Pf8/gAA9/z89/7+9/z7/Pf3/PcAAPf39wD3/vf39/cA9/cAAA=="},{"id":"char-b.1","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAANoA1NQA2gAAAAAAAAAA2gDU09fX09QA2gAAAAAAAADU2dfX19fX1AAAAADT09rU2dfX19fX19LU2gAA0tMA1NnX19fX19fS1AAAANLS09rX09PX19PT0toAAADS0tLU19PT19fT09LU0wAA09PS1NfX19fX19bS1NLTAAAA09rX19fT09bS0trS0gAAAADU19fX09PW0tLU09IAAAAA1NfX1tbW1tLS1NPTAAAA2trW1tbW0tbS0traAAAA1NPT1tLW1tLW0tPTAAAA09fW1tfX1tbX19fX19MAANTU1NTU1NTU1NTU1NTUAA=="},{"id":"char-b.2","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAADaANTUANoAAAAAAAAAANoA1NPX19PUANoAAAAAAAAA1NnX19fX19QAAAAAANPa1NnX19fX19fS1NoAAADS09TZ19fX19fX0tQAAAAA0tPa19PT19fT09LaAAAAANLS1NfT09fX09PS1NMAAADT0tTX19fX19fW0tTS0wAAANPa19fX09PW0tLa0tLTAAAA1NfX19PT1tLS1NPS0gAAANTX19bW1tbS0tMA09MAANra1tbW1tLW0tLa2gAAAAAA1NPS1tbS1tLS09PUAAAA09fW1tfX1tbX19fX19MAANTU1NTU1NTU1NTU1NTUAA=="},{"id":"char-b.3","pixels":"AAAAAADaANTUANoAAAAAAAAAANoA1NPX19PUANoAAAAAAAAA1NnX19fX19QAAAAA09Pa1NnX19fX19fS1NoAANLSANTZ19fX19fX0tQAAADS0tPa19PT19fT09LaAAAA0tLS1NfT09fX09PS1NMAANPS0tTX19fX19fW0tTS0wAA09Pa19fX09PW0tLa0tLTAAAA1NfX19PT1tLS1NPS0gAAANTX19bW1tbS0tQA09MAANra1tbW0tbW0tLa2gAAAAAA09LW1tLW1tLS0wAAAAAA1NPS1tbS1tbS0tPUAAAA09fW1tfX1tbX19fX19MAANTU1NTU1NTU1NTU1NTUAA=="},{"id":"char-c.1","pixels":"AAAAAADaANTUANoAAAAAAAAAANoA1NPX19PUANoAAAAAAAAA1NnX19fX19QAAAAAAADa1NnX19fX19fS1NrT0wAAANTZ19fX19fX0tQA0tIAAADa19PT19fT09La09LSAADT1NfT09fX09PS1NLS0gDT0tTX19fX19fW0tTS0tPT0tLa19fX09PW0tLa09MA0tLT1NfX19PT1tLS1AAAANPTANTX19bW1tbS0tQAAAAAANra1tbW0tbW0tLa2gAAAAAA09LW1tLW1tLS0wAAAAAA1NPS1tbS1tbS0tPUAAAA09fW1tfX1tbX19fX19MAANTU1NTU1NTU1NTU1NTUAA=="},{"id":"char-c.2","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAA2gDU1ADaAAAAAAAAAADaANTT19fT1ADaAAAAAAAAANTZ19fX19fUAAAAAAAA2tTZ19fX19fX0tTaAAAAAADU2dfX19fX19LUAAAAAADa2tfX19fX19fS2toAANPT09TX09PX19PT0tTT09PS0tLU19fX19fX1tLU0tLS09PT2tfX19PT1tLS2tPT0wAAANTX19fT09bS0tQAAAAAAADU19fW1tbW0tLUAAAAAADa2tbW1tLW1tLS2toAAAAA1NPS1tbS1tbS0tPUAAAA09fW1tfX1tbX19fX19MAANTU1NTU1NTU1NTU1NTUAA=="},{"id":"char-c.3","pixels":"AAAAAADaANTUANoAAAAAAAAAANoA1NPX19PUANoAAAAAAAAA1NfX19fX19QAAAAA09Pa1NfX19fX19fS1NoAANLSANTX19fX19fX0tQAAADS0tPa19PT19fT09LaAAAA0tLS1NfT09fX09PS1NMAANPS0tTX19fX19fW0tTS0wAA09Pa19fX09PW0tLa0tLTAAAA1NfX19PT1tLS1NPS0gAAANTX19bW1tbS0tQA09MAANra1tbW0tbW0tLa2gAAAAAA09LW1tLW1tLS0wAAAAAA1NPS1tbS1tbS0tPUAAAA09fW1tfX1tbX19fX19MAANTU1NTU1NTU1NTU1NTUAA=="},{"id":"char-d.1","pixels":"AAAAAAAAAAAA4eHh7gAAAAAAAAAAAAAA7ujr6OjuAAAAAAAAAAAA4ejowO7o6O4AAAAAAAAA4ejo6Ojo6OjuAAAAAADh4ejo6Ojo6Ojo5u4AAADu6Ojo6Ojo6Ojo7uHmAADu6Ojr6Ojo7ejo6OEA5gDh7ujo6Ojo6O7o6OjhAOEA7ujo6Ojo6Oju6Ojo4QAA4ejo6Ojo6Oju7ejo7uEAAOHo6Oju7u7u7ejo6OEAAADm6Obm7e3t7ejo5uYAAAAA7ubu7ejo6Obm4eEAAAAAAAAA4eHo6OEAAObmAAAAAAAAAAAA4eEAAAAA5u4AAAAAAAAAAADu4eEAAADu5uYAAA=="},{"id":"char-d.2","pixels":"AAAAAAAAAAAh4eHh7gAAAAAAAAAAAAAA7ujr6OjuAAAAAAAAAAAh4ejowO7o6O4AAAAAIeHh7ujo6Ojo6OjuAAAAIe7o6Ojo6Ojo6Ojo5u4AAO7o6Ovo6Ojt6Ojo7uHmAOHu6Ojo6Ojo7ujo6OEA5u7o6Ojo6Ojo6O7o6OjhAOHh6Ojo6Ojo6O7t6Oju4QAA4ejo6O7u7u7t6Ojo4QAAAOHu5ubt7e3o6Ojo4QAAAAAA5u7t7ejo6Ojh7u4AAAAAAADm5u3o6Ojo4eHuAAAAAAAAAOHh4ejo7ubmAAAAAAAAAAAAAADh4eHhIQAAAAAAAAAAAAAAAAAA5uYAAAAAAA=="},{"id":"char-d.3","pixels":"AAAAAAAAAAAA4eHh7gAAAAAAAAAAAAAA7ujr6OjuAAAAAAAAAAAA4ejowO7o6O4AAAAAAAAAAOHo6Ojo6OjuAAAAAAAA4eHo6Ojo6Ojo5u4AAAAA7ujo6Ojo6Ojo7uHmAAAA7ujo6+jo6O3o6OYA5gAA4e7o6Ojo6Oju6Ojo7uEAAO7o6Ojo6Ojo7ujo6OEAAOHo6Ojo6Ojo7u3o6OjhAADh6Ojo7u7u7u3o6Ojo4QAA5u7m5u3t7ejo6Ojo4QAAAO7m5ubm7ejo6Ojo5gAAAAAAAAAA5ubh7ujo5u4AAAAAAAAAAO7uAOHu4eEAAAAAAAAAAAAA5uYAAADh4eYAAA=="},{"id":"char-e.1","pixels":"AODg4eHhAAAAAAAAAAAAAAAA4ODd3eHgAODgAAAAAAAAAAAg4d3d3eEA4eAAAAAAAAAAICDh3d3d4eHd4eEAAAAAAAAg4d3d3eDf3d3d4QAAAAAA4eDd3d3f3cDg3d3hAAAA4eDg3d3d3d3d3d3d4QAA4N3f4N3d3d3f4eHh4eAA4d3d3d3d3d3h4QAAAAAAAOHd3d3d3d3hAAAAAAAAAADh3d/f4eHhAAAAAAAAAAAA4d/f4QAAAAAAAAAAAAAA4eDg4QAAAAAAAAAAAAAAAOHg4QAAAAAAAAAAAAAAAADh4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="},{"id":"char-e.2","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODgAAAAAAAAAAAAAAAAAAAA4eAAAAAAAAAAAAAAAAAA4eHd4eEAAAAAAAAA4eHh4N3d3d3d4QAAAAAA4eHd3d3d3cDg3d3hAAAA4eHd3d3g4N/d3d3d4QAA4N3d3eDh4d/g4eHh4eAA4d3d4OHh39/h4QAAAAAAAOHd4OHf393hAAAAAAAAAADh3d/f4eHhAAAAAAAAAAAA4d/f4QAAAAAAAAAAAAAA4eDg4QAAAAAAAAAAAAAAAOHg4QAAAAAAAAAAAAAAAADh4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="},{"id":"char-e.3","pixels":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADg4AAAAAAAAAAAAAAAAAAAAOHgAAAAAAAAAAAAAAAAAOHh3eHhAAAAAAAAAADh4eDd3d3d3eEAAAAAAOHh4d3d3d3A4N3d4QAAAOHg3d3d4d/d3d3d3eEAAODd3d3d3d3h4OHh4eHgAOHd3d3d3d3d3eDhAAAAAADh3d3d4N/d3d3d4OEAAAAA4d3f3+Hg4N3d3d3hAAAAAOHf3+EAAOHf3d3d3eEAAOHg4OEAAAAA4eHd3d3hAADh4OEAAAAAAAAA4eHf4QAA4eAAAAAAAAAAAAAA4eAAAA=="}],"audio_clips":[{"id":"jump","speed":6,"notes":"P5w5rDW4MsAxwDDAMAAwADAAMAAwADAAMAAwADAAMAA="},{"id":"start","speed":5,"notes":"B7gP1AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},{"id":"restart","speed":5,"notes":"P6w9uDrAOMA6zDAAMAAwADAAMAAwADAAMAAwADAAMAA="},{"id":"end","speed":4,"notes":"L9QhnC/ML8AgpC+cL7ggrC2kLawgnC+ILGAqYCZgImA="}]}